{"dependencies":[{"name":"expo/virtual/env","data":{"asyncType":null,"isESMImport":false,"locs":[],"key":"dgHc21cgR+buKc7O3/dChhD5JJk=","exportNames":["*"],"imports":1}}],"output":[{"data":{"code":"__d(function (global, require, _$$_IMPORT_DEFAULT, _$$_IMPORT_ALL, module, exports, _dependencyMap) {\n  \"use strict\";\n\n  Object.defineProperty(exports, '__esModule', {\n    value: true\n  });\n  Object.defineProperty(exports, \"API_BASE\", {\n    enumerable: true,\n    get: function () {\n      return API_BASE;\n    }\n  });\n  exports.apiGet = apiGet;\n  exports.apiPost = apiPost;\n  exports.followUser = followUser;\n  exports.unfollowUser = unfollowUser;\n  exports.getFollowStatus = getFollowStatus;\n  exports.presenceWatch = presenceWatch;\n  exports.presenceLeave = presenceLeave;\n  exports.getEventPresence = getEventPresence;\n  exports.attachPlayback = attachPlayback;\n  var _expoVirtualEnv = require(_dependencyMap[0], \"expo/virtual/env\");\n  const BASE = process.env.EXPO_BACKEND_URL || _expoVirtualEnv.env.EXPO_PUBLIC_BACKEND_URL || \"\";\n  const API_BASE = BASE.endsWith(\"/\") ? BASE.slice(0, -1) : BASE;\n  function buildUrl(path) {\n    if (!path.startsWith(\"/\")) path = `/${path}`;\n    return `${API_BASE}${path}`;\n  }\n  async function apiGet(path) {\n    const res = await fetch(buildUrl(path));\n    if (!res.ok) throw new Error(`${res.status}`);\n    return res.json();\n  }\n  async function apiPost(path, body, init) {\n    const res = await fetch(buildUrl(path), Object.assign({\n      method: \"POST\",\n      headers: Object.assign({\n        \"Content-Type\": \"application/json\"\n      }, init?.headers || {}),\n      body: body ? JSON.stringify(body) : undefined\n    }, init || {}));\n    if (!res.ok) throw new Error(`${res.status}`);\n    return res.json();\n  }\n\n  // Social graph\n  async function followUser(followerId, followingId) {\n    return apiPost(\"/api/follows\", {\n      follower_id: followerId,\n      following_id: followingId,\n      action: \"follow\"\n    });\n  }\n  async function unfollowUser(followerId, followingId) {\n    return apiPost(\"/api/follows\", {\n      follower_id: followerId,\n      following_id: followingId,\n      action: \"unfollow\"\n    });\n  }\n  async function getFollowStatus(followerId, followingId) {\n    return apiGet(`/api/follows/status?follower_id=${encodeURIComponent(followerId)}&following_id=${encodeURIComponent(followingId)}`);\n  }\n\n  // Presence\n  async function presenceWatch(userId, eventId) {\n    return apiPost(\"/api/presence/watch\", {\n      user_id: userId,\n      event_id: eventId\n    });\n  }\n  async function presenceLeave(userId, eventId) {\n    return apiPost(\"/api/presence/leave\", {\n      user_id: userId,\n      event_id: eventId\n    });\n  }\n  async function getEventPresence(eventId, userId) {\n    const q = userId ? `?user_id=${encodeURIComponent(userId)}` : \"\";\n    return apiGet(`/api/events/${eventId}/presence${q}`);\n  }\n\n  // Streams helper\n  async function attachPlayback(streamId, playbackUrl) {\n    return apiPost(`/api/streams/${streamId}/attach_playback`, undefined, {\n      headers: {\n        \"Content-Type\": \"application/x-www-form-urlencoded\"\n      },\n      body: JSON.stringify({\n        playback_url: playbackUrl\n      })\n    });\n  }\n});","lineCount":94,"map":[[7,2,2,0,"Object"],[7,8,2,0],[7,9,2,0,"defineProperty"],[7,23,2,0],[7,24,2,0,"exports"],[7,31,2,0],[8,4,2,0,"enumerable"],[8,14,2,0],[9,4,2,0,"get"],[9,7,2,0],[9,18,2,0,"get"],[9,19,2,0],[10,6,2,0],[10,13,2,0,"API_BASE"],[10,21,2,0],[11,4,2,0],[12,2,2,0],[13,2,9,0,"exports"],[13,9,9,0],[13,10,9,0,"apiGet"],[13,16,9,0],[13,19,9,0,"apiGet"],[13,25,9,0],[14,2,15,0,"exports"],[14,9,15,0],[14,10,15,0,"apiPost"],[14,17,15,0],[14,20,15,0,"apiPost"],[14,27,15,0],[15,2,27,0,"exports"],[15,9,27,0],[15,10,27,0,"followUser"],[15,20,27,0],[15,23,27,0,"followUser"],[15,33,27,0],[16,2,30,0,"exports"],[16,9,30,0],[16,10,30,0,"unfollowUser"],[16,22,30,0],[16,25,30,0,"unfollowUser"],[16,37,30,0],[17,2,33,0,"exports"],[17,9,33,0],[17,10,33,0,"getFollowStatus"],[17,25,33,0],[17,28,33,0,"getFollowStatus"],[17,43,33,0],[18,2,38,0,"exports"],[18,9,38,0],[18,10,38,0,"presenceWatch"],[18,23,38,0],[18,26,38,0,"presenceWatch"],[18,39,38,0],[19,2,39,0,"exports"],[19,9,39,0],[19,10,39,0,"presenceLeave"],[19,23,39,0],[19,26,39,0,"presenceLeave"],[19,39,39,0],[20,2,40,0,"exports"],[20,9,40,0],[20,10,40,0,"getEventPresence"],[20,26,40,0],[20,29,40,0,"getEventPresence"],[20,45,40,0],[21,2,46,0,"exports"],[21,9,46,0],[21,10,46,0,"attachPlayback"],[21,24,46,0],[21,27,46,0,"attachPlayback"],[21,41,46,0],[22,2,51,1],[22,6,51,1,"_expoVirtualEnv"],[22,21,51,1],[22,24,51,1,"require"],[22,31,51,1],[22,32,51,1,"_dependencyMap"],[22,46,51,1],[23,2,1,0],[23,8,1,6,"BASE"],[23,12,1,10],[23,15,1,13,"process"],[23,22,1,20],[23,23,1,21,"env"],[23,26,1,24],[23,27,1,25,"EXPO_BACKEND_URL"],[23,43,1,41],[23,47,1,41,"_expoVirtualEnv"],[23,62,1,41],[23,63,1,41,"env"],[23,66,1,41],[23,67,1,41,"EXPO_PUBLIC_BACKEND_URL"],[23,90,1,80],[23,94,1,84],[23,96,1,86],[24,2,2,7],[24,8,2,13,"API_BASE"],[24,16,2,21],[24,19,2,24,"BASE"],[24,23,2,28],[24,24,2,29,"endsWith"],[24,32,2,37],[24,33,2,38],[24,36,2,41],[24,37,2,42],[24,40,2,45,"BASE"],[24,44,2,49],[24,45,2,50,"slice"],[24,50,2,55],[24,51,2,56],[24,52,2,57],[24,54,2,59],[24,55,2,60],[24,56,2,61],[24,57,2,62],[24,60,2,65,"BASE"],[24,64,2,69],[25,2,4,0],[25,11,4,9,"buildUrl"],[25,19,4,17,"buildUrl"],[25,20,4,18,"path"],[25,24,4,30],[25,26,4,32],[26,4,5,2],[26,8,5,6],[26,9,5,7,"path"],[26,13,5,11],[26,14,5,12,"startsWith"],[26,24,5,22],[26,25,5,23],[26,28,5,26],[26,29,5,27],[26,31,5,29,"path"],[26,35,5,33],[26,38,5,36],[26,42,5,40,"path"],[26,46,5,44],[26,48,5,46],[27,4,6,2],[27,11,6,9],[27,14,6,12,"API_BASE"],[27,22,6,20],[27,25,6,23,"path"],[27,29,6,27],[27,31,6,29],[28,2,7,0],[29,2,9,7],[29,17,9,22,"apiGet"],[29,23,9,28,"apiGet"],[29,24,9,32,"path"],[29,28,9,44],[29,30,9,58],[30,4,10,2],[30,10,10,8,"res"],[30,13,10,11],[30,16,10,14],[30,22,10,20,"fetch"],[30,27,10,25],[30,28,10,26,"buildUrl"],[30,36,10,34],[30,37,10,35,"path"],[30,41,10,39],[30,42,10,40],[30,43,10,41],[31,4,11,2],[31,8,11,6],[31,9,11,7,"res"],[31,12,11,10],[31,13,11,11,"ok"],[31,15,11,13],[31,17,11,15],[31,23,11,21],[31,27,11,25,"Error"],[31,32,11,30],[31,33,11,31],[31,36,11,34,"res"],[31,39,11,37],[31,40,11,38,"status"],[31,46,11,44],[31,48,11,46],[31,49,11,47],[32,4,12,2],[32,11,12,9,"res"],[32,14,12,12],[32,15,12,13,"json"],[32,19,12,17],[32,20,12,18],[32,21,12,19],[33,2,13,0],[34,2,15,7],[34,17,15,22,"apiPost"],[34,24,15,29,"apiPost"],[34,25,15,39,"path"],[34,29,15,51],[34,31,15,53,"body"],[34,35,15,63],[34,37,15,65,"init"],[34,41,15,83],[34,43,15,97],[35,4,16,2],[35,10,16,8,"res"],[35,13,16,11],[35,16,16,14],[35,22,16,20,"fetch"],[35,27,16,25],[35,28,16,26,"buildUrl"],[35,36,16,34],[35,37,16,35,"path"],[35,41,16,39],[35,42,16,40],[35,44,16,40,"Object"],[35,50,16,40],[35,51,16,40,"assign"],[35,57,16,40],[36,6,17,4,"method"],[36,12,17,10],[36,14,17,12],[36,20,17,18],[37,6,18,4,"headers"],[37,13,18,11],[37,15,18,11,"Object"],[37,21,18,11],[37,22,18,11,"assign"],[37,28,18,11],[38,8,18,15],[38,22,18,29],[38,24,18,31],[39,6,18,49],[39,9,18,55,"init"],[39,13,18,59],[39,15,18,61,"headers"],[39,22,18,68],[39,26,18,72],[39,27,18,73],[39,28,18,74],[39,29,18,77],[40,6,19,4,"body"],[40,10,19,8],[40,12,19,10,"body"],[40,16,19,14],[40,19,19,17,"JSON"],[40,23,19,21],[40,24,19,22,"stringify"],[40,33,19,31],[40,34,19,32,"body"],[40,38,19,36],[40,39,19,37],[40,42,19,40,"undefined"],[41,4,19,49],[41,7,20,8,"init"],[41,11,20,12],[41,15,20,16],[41,16,20,17],[41,17,20,18],[41,18,21,3],[41,19,21,4],[42,4,22,2],[42,8,22,6],[42,9,22,7,"res"],[42,12,22,10],[42,13,22,11,"ok"],[42,15,22,13],[42,17,22,15],[42,23,22,21],[42,27,22,25,"Error"],[42,32,22,30],[42,33,22,31],[42,36,22,34,"res"],[42,39,22,37],[42,40,22,38,"status"],[42,46,22,44],[42,48,22,46],[42,49,22,47],[43,4,23,2],[43,11,23,9,"res"],[43,14,23,12],[43,15,23,13,"json"],[43,19,23,17],[43,20,23,18],[43,21,23,19],[44,2,24,0],[46,2,26,0],[47,2,27,7],[47,17,27,22,"followUser"],[47,27,27,32,"followUser"],[47,28,27,33,"followerId"],[47,38,27,51],[47,40,27,53,"followingId"],[47,51,27,72],[47,53,27,74],[48,4,28,2],[48,11,28,9,"apiPost"],[48,18,28,16],[48,19,28,17],[48,33,28,31],[48,35,28,33],[49,6,28,35,"follower_id"],[49,17,28,46],[49,19,28,48,"followerId"],[49,29,28,58],[50,6,28,60,"following_id"],[50,18,28,72],[50,20,28,74,"followingId"],[50,31,28,85],[51,6,28,87,"action"],[51,12,28,93],[51,14,28,95],[52,4,28,104],[52,5,28,105],[52,6,28,106],[53,2,29,0],[54,2,30,7],[54,17,30,22,"unfollowUser"],[54,29,30,34,"unfollowUser"],[54,30,30,35,"followerId"],[54,40,30,53],[54,42,30,55,"followingId"],[54,53,30,74],[54,55,30,76],[55,4,31,2],[55,11,31,9,"apiPost"],[55,18,31,16],[55,19,31,17],[55,33,31,31],[55,35,31,33],[56,6,31,35,"follower_id"],[56,17,31,46],[56,19,31,48,"followerId"],[56,29,31,58],[57,6,31,60,"following_id"],[57,18,31,72],[57,20,31,74,"followingId"],[57,31,31,85],[58,6,31,87,"action"],[58,12,31,93],[58,14,31,95],[59,4,31,106],[59,5,31,107],[59,6,31,108],[60,2,32,0],[61,2,33,7],[61,17,33,22,"getFollowStatus"],[61,32,33,37,"getFollowStatus"],[61,33,33,38,"followerId"],[61,43,33,56],[61,45,33,58,"followingId"],[61,56,33,77],[61,58,33,79],[62,4,34,2],[62,11,34,9,"apiGet"],[62,17,34,15],[62,18,34,40],[62,53,34,75,"encodeURIComponent"],[62,71,34,93],[62,72,34,94,"followerId"],[62,82,34,104],[62,83,34,105],[62,100,34,122,"encodeURIComponent"],[62,118,34,140],[62,119,34,141,"followingId"],[62,130,34,152],[62,131,34,153],[62,133,34,155],[62,134,34,156],[63,2,35,0],[65,2,37,0],[66,2,38,7],[66,17,38,22,"presenceWatch"],[66,30,38,35,"presenceWatch"],[66,31,38,36,"userId"],[66,37,38,50],[66,39,38,52,"eventId"],[66,46,38,67],[66,48,38,69],[67,4,38,71],[67,11,38,78,"apiPost"],[67,18,38,85],[67,19,38,86],[67,40,38,107],[67,42,38,109],[68,6,38,111,"user_id"],[68,13,38,118],[68,15,38,120,"userId"],[68,21,38,126],[69,6,38,128,"event_id"],[69,14,38,136],[69,16,38,138,"eventId"],[70,4,38,146],[70,5,38,147],[70,6,38,148],[71,2,38,150],[72,2,39,7],[72,17,39,22,"presenceLeave"],[72,30,39,35,"presenceLeave"],[72,31,39,36,"userId"],[72,37,39,50],[72,39,39,52,"eventId"],[72,46,39,67],[72,48,39,69],[73,4,39,71],[73,11,39,78,"apiPost"],[73,18,39,85],[73,19,39,86],[73,40,39,107],[73,42,39,109],[74,6,39,111,"user_id"],[74,13,39,118],[74,15,39,120,"userId"],[74,21,39,126],[75,6,39,128,"event_id"],[75,14,39,136],[75,16,39,138,"eventId"],[76,4,39,146],[76,5,39,147],[76,6,39,148],[77,2,39,150],[78,2,40,7],[78,17,40,22,"getEventPresence"],[78,33,40,38,"getEventPresence"],[78,34,40,39,"eventId"],[78,41,40,54],[78,43,40,56,"userId"],[78,49,40,71],[78,51,40,73],[79,4,41,2],[79,10,41,8,"q"],[79,11,41,9],[79,14,41,12,"userId"],[79,20,41,18],[79,23,41,21],[79,35,41,33,"encodeURIComponent"],[79,53,41,51],[79,54,41,52,"userId"],[79,60,41,58],[79,61,41,59],[79,63,41,61],[79,66,41,64],[79,68,41,66],[80,4,42,2],[80,11,42,9,"apiGet"],[80,17,42,15],[80,18,42,90],[80,33,42,105,"eventId"],[80,40,42,112],[80,52,42,124,"q"],[80,53,42,125],[80,55,42,127],[80,56,42,128],[81,2,43,0],[83,2,45,0],[84,2,46,7],[84,17,46,22,"attachPlayback"],[84,31,46,36,"attachPlayback"],[84,32,46,37,"streamId"],[84,40,46,53],[84,42,46,55,"playbackUrl"],[84,53,46,74],[84,55,46,76],[85,4,47,2],[85,11,47,9,"apiPost"],[85,18,47,16],[85,19,47,17],[85,35,47,33,"streamId"],[85,43,47,41],[85,61,47,59],[85,63,47,61,"undefined"],[85,72,47,70],[85,74,47,72],[86,6,48,4,"headers"],[86,13,48,11],[86,15,48,13],[87,8,48,15],[87,22,48,29],[87,24,48,31],[88,6,48,67],[88,7,48,68],[89,6,49,4,"body"],[89,10,49,8],[89,12,49,10,"JSON"],[89,16,49,14],[89,17,49,15,"stringify"],[89,26,49,24],[89,27,49,25],[90,8,49,27,"playback_url"],[90,20,49,39],[90,22,49,41,"playbackUrl"],[91,6,49,53],[91,7,49,54],[92,4,50,2],[92,5,50,10],[92,6,50,11],[93,2,51,0],[94,0,51,1],[94,3]],"functionMap":{"names":["<global>","buildUrl","apiGet","apiPost","followUser","unfollowUser","getFollowStatus","presenceWatch","presenceLeave","getEventPresence","attachPlayback"],"mappings":"AAA;ACG;CDG;OEE;CFI;OGE;CHS;OIG;CJE;OKC;CLE;OMC;CNE;OOG,gJP;OQC,gJR;OSC;CTG;OUG;CVK"},"hasCjsExports":false},"type":"js/module"}]}